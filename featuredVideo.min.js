/*!
featuredVideo v1.0.6 (http://okize.github.com/)
Copyright (c) 2013 | Licensed under the MIT license
http://www.opensource.org/licenses/mit-license.php
*/
(function(){(function(t){return"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)})(function(t){"use strict";var i,e,o;o="featuredVideo",e={autoplayFirstVideo:!0,defaultVideoId:!1,supportsDeepLinking:!0,showPlaylist:!0,showPlaylistTooltips:!0,tooltipHtml:'<div class="featuredVideoPlaylistTooltip"></div>'},i=function(){function i(i,o){this.element=i,this.el=t(this.element),this.options=t.extend({},e,o),this.activeVideoId=null,this.hashVideoId=this.getVideoIdFromUrl(),this.player=this.el.find(".featuredplayer"),this.playlist=this.el.find(".featuredVideoPlaylist"),this.playlistVideos=this.playlist.find("li"),this.playlistVideosCount=this.playlistVideos.length,this.playlistFirstVideoEl=this.playlistVideos.eq(0),this.playlistFirstVideoId=this.playlistFirstVideoEl.data("videoId")||null,this.playOnHashChange=!0,this.stateKey="videoId",this.hashObject=null,this.init()}return i.prototype.init=function(){return this.sanityCheck(),this.getPlayer()},i.prototype.player={},i.prototype.sanityCheck=function(){var i;return 0>=this.playlistVideosCount||!this.playlistFirstVideoId||""===this.playlistFirstVideoId?(this.el.hide(),t.error("no video ids specified in featured video playlist!")):(i=this.getDuplicatePlaylistIds(),i.length>0?console.error("WARNING! duplicate ids found in the featured video playlist: ",i):void 0)},i.prototype.getPlayer=function(){var i,e,o=this;return i={url:"http://admin.brightcove.com/js/BrightcoveExperiences.js",isLoaded:t(document).data("playerScriptLoaded")||!1},e=i.isLoaded?this.resolve():this.loadPlayerScript(i.url),t.when(e).done(function(){return o.initializePlayer()}).fail(function(){return t.error("Brightcove script failed to load")})},i.prototype.loadPlayerScript=function(i){var e;return e=t.ajax(i,{dataType:"script"})},i.prototype.initializePlayer=function(){var t,i=this;return t=window.brightcove||{},window.brightcovePlayerLoaded=function(e){var o;return o=t.api.getExperience(e),i.player=o.getModule(t.api.modules.APIModules.VIDEO_PLAYER)},window.brightcovePlayerReady=function(){var t;return t=i.options.autoplayFirstVideo?"load":"cue",i.playVideo(t,i.getVideoId()),i.initializePlaylist()},t.createExperiences()},i.prototype.playVideo=function(t,i,e){return e===void 0&&(e="none"),"load"===t?this.player.loadVideoByID(i):"cue"===t&&this.player.cueVideoByID(i),this.options.showPlaylist?this.activatePlaylistItem(void 0,e):void 0},i.prototype.getVideoId=function(t){return this.activeVideoId=t!==void 0?t.data("videoId"):this.hashVideoId&&this.hasValidId(this.hashVideoId)?this.hashVideoId:this.playlistFirstVideoId,this.activeVideoId},i.prototype.hasValidId=function(t){var i,e,o;for(e=this.getPlaylistIds(),i=0,o=e.length;o>i;){if(e[i]===t)return!0;i++}return!1},i.prototype.activatePlaylistItem=function(t,i){return t===void 0&&(t=this.playlist.find("li[data-video-id="+this.activeVideoId+"]")),"click"!==i&&this.bringPlaylistItemIntoView(t.get(0)),this.playlistVideos.removeClass("active"),t.addClass("active")},i.prototype.bringPlaylistItemIntoView=function(t){return t===void 0?!1:t.scrollIntoViewIfNeeded?t.scrollIntoViewIfNeeded(!0):t.scrollIntoView(!0)},i.prototype.initializePlaylist=function(){var i=this;return this.options.showPlaylist?(this.options.supportsDeepLinking&&this.initializeHashLinking(),this.playlist.on("click","li",function(e){var o;return e.preventDefault(),o=t(e.currentTarget).data("videoId"),i.updateUrlHash(o),i.activeVideoId=o,i.playOnHashChange=!1,i.playVideo("load",o,e.type)}),this.options.showPlaylistTooltips&&this.initializePlaylistTooltips(),this.playlist.css("visibility","visible")):(this.playlist.remove(),this.el.addClass("noPlaylist"),void 0)},i.prototype.initializePlaylistTooltips=function(){var i,e;return e=t(this.options.tooltipHtml),i=this.playlist.offset(),this.el.append(e),this.playlistVideos.on({mouseenter:function(){var o,s,l;return o=t(this),l=o.find(".featuredVideoSummary").text(),s={top:o.offset().top-i.top},""!==l?e.text(l).css("top",s.top).show():void 0},mouseleave:function(){return e.hide()}})},i.prototype.getPlaylistIds=function(){var i;return i=[],this.playlistVideos.each(function(){var e;return e=""+t(this).data("videoId"),i.push(e)}),i},i.prototype.getDuplicatePlaylistIds=function(){var t,i,e,o,s,l;for(o=this.getPlaylistIds(),i=[],t={},s=void 0,e=0,l=o.length;l>e;)s=""+o[e],t[s]===void 0?t[s]=!0:i.push(s),e++;return i},i.prototype.updateUrlHash=function(t){return this.options.supportsDeepLinking?window.location.hash="videoId="+t:void 0},i.prototype.initializeHashLinking=function(){var i=this;return"onhashchange"in window?t(window).on("hashchange",function(t){return console.log("hash changed"),t.preventDefault(),i.playOnHashChange&&(i.activeVideoId=i.getVideoIdFromUrl(),i.playVideo("load",i.activeVideoId)),i.playOnHashChange=!0}):void 0},i.prototype.getVideoIdFromUrl=function(){var t,i;return t=this.getArgsFromUrl(),i=t[this.stateKey],console.log(this.stateKey),console.log(i),i===void 0&&(i=null),i},i.prototype.getArgsFromUrl=function(t){var i,e,o,s,l;for(t=t||window.location.href,i={},l=t.slice(t.indexOf("#")+1).split("&"),e=0,o=l.length;o>e;)s=l[e].split("="),i[s[0]]=s.length>1?s[1]:null,e++;return i},i}(),t.fn[o]=function(e){return this.each(function(){t.data(this,"plugin_#{pluginName}")||t.data(this,"plugin_#{pluginName}",new i(this,e))})}})}).call(this);
/*
//@ sourceMappingURL=featuredVideo.min.js.map
*/