/*!
featuredVideo v1.0.6 (http://okize.github.com/)
Copyright (c) 2013 | Licensed under the MIT license
http://www.opensource.org/licenses/mit-license.php
*/
(function(){(function(t){return"function"==typeof define&&define.amd?define(["jquery"],t):t(jQuery)})(function(t){"use strict";var i,e,o;o="featuredVideo",e={autoplayFirstVideo:!0,supportsDeepLinking:!0,showPlaylist:!0,showPlaylistTooltips:!0,tooltipHtml:'<div class="featuredVideoPlaylistTooltip"></div>'},i=function(){function i(i,o){this.element=i,this.el=t(this.element),this.options=t.extend({},e,o),this.player=this.el.find(".featuredplayer"),this.playlist=this.el.find(".featuredVideoPlaylist"),this.playlistVideos=this.playlist.find("li"),this.playlistVideosCount=this.playlistVideos.length,this.playlistFirstVideoId=this.playlistVideos.eq(0).data("videoId")||null,this.stateKey="videoId",this.activeVideoId=null,this.hashObject=null,this.playOnHashChange=!0,this.hashVideoId=this.getVideoIdFromUrl(),this.init()}return i.prototype.init=function(){return this.sanityCheck(),this.getPlayer()},i.prototype.sanityCheck=function(){var i;return 0>=this.playlistVideosCount||!this.playlistFirstVideoId||""===this.playlistFirstVideoId?(this.el.hide(),t.error("no video ids specified in featured video playlist!")):(i=this.getDuplicatePlaylistIds(),i.length>0?console.error("WARNING! duplicate ids found in the featured video playlist: ",i):void 0)},i.prototype.player={},i.prototype.getPlayer=function(){var i,e,o=this;return i={url:"http://admin.brightcove.com/js/BrightcoveExperiences.js",isLoaded:t(document).data("playerScriptLoaded")||!1},e=i.isLoaded?this.resolve():this.loadPlayerScript(i.url),t.when(e).done(function(){return o.initializePlayer()}).fail(function(){return t.error("Brightcove script failed to load")})},i.prototype.loadPlayerScript=function(i){var e;return e=t.ajax(i,{dataType:"script"})},i.prototype.initializePlayer=function(){var t,i=this;return t=window.brightcove||{},window.brightcovePlayerLoaded=function(e){var o;return o=t.api.getExperience(e),i.player=o.getModule(t.api.modules.APIModules.VIDEO_PLAYER)},window.brightcovePlayerReady=function(){var t;return t=i.options.autoplayFirstVideo?"load":"cue",i.playVideo(t,i.getVideo()),i.initializePlaylist()},t.createExperiences()},i.prototype.playVideo=function(t,i,e){return e===void 0&&(e="none"),"load"===t?this.player.loadVideoByID(i):"cue"===t?this.player.cueVideoByID(i):void 0},i.prototype.getVideo=function(i){return this.activeVideoId=i!==void 0?t(i).data("videoId"):this.hashVideoId&&this.hasValidId(this.hashVideoId)?this.hashVideoId:this.playlistFirstVideoId,this.activeVideoId},i.prototype.hasValidId=function(t){var i,e,o;for(e=this.getPlaylistIds(),i=0,o=e.length;o>i;){if(e[i]===t)return!0;i++}return!1},i.prototype.activatePlaylistItem=function(t,i){return t===void 0&&(t=this.playlist.find("li[data-video-id="+this.activeVideoId+"]")),"click"!==i&&this.bringPlaylistItemIntoView(t.get(0)),this.playlistVideos.removeClass("active"),t.addClass("active")},i.prototype.bringPlaylistItemIntoView=function(t){return t===void 0?!1:t.scrollIntoViewIfNeeded?t.scrollIntoViewIfNeeded(!0):t.scrollIntoView(!0)},i.prototype.initializePlaylist=function(){var t=this;return this.options.showPlaylist?(this.playlist.on("click","li",function(i){return i.preventDefault(),t.updateState(t.getVideo(i.currentTarget),i)}),this.options.showPlaylistTooltips&&this.initializePlaylistTooltips(),this.playlist.css("visibility","visible")):(this.playlist.remove(),this.el.addClass("noPlaylist"),void 0)},i.prototype.initializePlaylistTooltips=function(){var i,e;return e=t(this.options.tooltipHtml),i=this.playlist.offset(),this.el.append(e),this.playlistVideos.on({mouseenter:function(){var o,s,a;return o=t(this),a=o.find(".featuredVideoSummary").text(),s={top:o.offset().top-i.top},""!==a?e.text(a).css("top",s.top).show():void 0},mouseleave:function(){return e.hide()}})},i.prototype.getPlaylistIds=function(){var i;return i=[],this.playlistVideos.each(function(){var e;return e=""+t(this).data("videoId"),i.push(e)}),i},i.prototype.getDuplicatePlaylistIds=function(){var t,i,e,o,s,a;for(o=this.getPlaylistIds(),i=[],t={},s=void 0,e=0,a=o.length;a>e;)s=""+o[e],t[s]===void 0?t[s]=!0:i.push(s),e++;return i},i.prototype.initializeHashLinking=function(){},i.prototype.getStateFromHash=function(){var t,i;return this.hashObject=this.getHashObject(),this.hashObject?(t=null!=(i=this.hashObject[this.stateKey])?i:null,t?this.activeTab=this.hashObject[this.stateKey]:null):null},i.prototype.updateUrlHash=function(t){return this.options.supportsDeepLinking?window.location.hash="videoId="+t:void 0},i.prototype.getVideoIdFromUrl=function(){var t,i;return t=this.getHashObject(),i=null!=t?t[this.stateKey]:this.getVideoIdFromQueryString(),(i===void 0||""===i)&&(i=null),i},i.prototype.getUrlHash=function(){return window.location.hash?window.location.hash.substring(1):null},i.prototype.getHashObject=function(){var t,i,e,o,s,a,n;if(o=this.getUrlHash(),!o)return null;for(i={},e=o.split("&"),a=0,n=e.length;n>a;a++)s=e[a],t=s.split("="),i[t[0]]=t.length>1?t[1]:void 0;return i},i.prototype.getVideoIdFromQueryString=function(){var t;return t=window.location.search.match(RegExp("[?&]bctid=([^&]+)(&|$)")),t&&decodeURIComponent(t[1].replace(/\+/g," "))},i.prototype.buildHashObject=function(){return t.param(this.hashObject)},i.prototype.updateHash=function(t){return t+="",this.hashObject=this.getHashObject(),this.hashObject||(this.hashObject={}),this.hashObject[this.stateKey]=t,this.setUrlHash(this.buildHashObject())},i.prototype.setUrlHash=function(t){return window.location.hash=t},i.prototype.updateState=function(t,i){return this.activeVideoId=t,this.playVideo("load",t,i.type),this.options.showPlaylist?this.activatePlaylistItem(void 0,i.type):void 0},i}(),t.fn[o]=function(e){return this.each(function(){t.data(this,"plugin_#{pluginName}")||t.data(this,"plugin_#{pluginName}",new i(this,e))})}})}).call(this);
/*
//@ sourceMappingURL=featuredVideo.min.js.map
*/